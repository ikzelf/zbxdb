<?xml version="1.0" ?>
<zabbix_export>
	<version>5.0</version>
	<date>2016-01-01T01:01:01Z</date>
	<groups>
        <group>
            <name>Templates</name>
        </group>
	</groups>
	<templates>
		<template>
			<template>template zbxDB</template>
			<name>template zbxDB</name>
			<description>DB monitoring done by zbxdb
refrain from using &quot;,&quot; in item names to prevent trouble with graph widgets in dashboards. &lt;https://github.com/ikzelf/zbxdb/issues/14&gt;</description>
			<groups>
                <group>
                    <name>Templates</name>
                </group>
			</groups>
			<applications>
				<application>
					<name>ACFS</name>
				</application>
				<application>
					<name>ASM</name>
				</application>
				<application>
					<name>ASMVG</name>
				</application>
				<application>
					<name>backup</name>
				</application>
				<application>
					<name>bloat</name>
				</application>
				<application>
					<name>db</name>
				</application>
				<application>
					<name>ha</name>
				</application>
				<application>
					<name>inst</name>
				</application>
				<application>
					<name>inst.parm</name>
				</application>
				<application>
					<name>inst.perf</name>
				</application>
				<application>
					<name>jobs</name>
				</application>
				<application>
					<name>license</name>
				</application>
				<application>
					<name>locks</name>
				</application>
				<application>
					<name>log</name>
				</application>
				<application>
					<name>objects</name>
				</application>
				<application>
					<name>performance</name>
				</application>
				<application>
					<name>sql</name>
				</application>
				<application>
					<name>tsmaxsize</name>
				</application>
				<application>
					<name>tspctfree</name>
				</application>
				<application>
					<name>tssize</name>
				</application>
				<application>
					<name>tsused</name>
				</application>
				<application>
					<name>ttsmaxsize</name>
				</application>
				<application>
					<name>ttspctfree</name>
				</application>
				<application>
					<name>ttssize</name>
				</application>
				<application>
					<name>ttsused</name>
				</application>
				<application>
					<name>undoTS</name>
				</application>
				<application>
					<name>users</name>
				</application>
				<application>
					<name>zbxdb</name>
				</application>
			</applications>
			<items>
				<item>
					<name>blocked[count]</name>
					<type>TRAP</type>
					<key>blocked[count]</key>
					<delay>0</delay>
					<history>1w</history>
					<applications>
						<application>
							<name>locks</name>
						</application>
					</applications>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{min(10m)}&gt;0</expression>
							<name>blocked during &gt; 10m</name>
							<priority>INFO</priority>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>blocked[topsid]</name>
					<type>TRAP</type>
					<key>blocked[topsid]</key>
					<delay>0</delay>
					<history>2w</history>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<description>instance#/sid(#victims)</description>
					<applications>
						<application>
							<name>locks</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>db[current_scn]</name>
					<type>TRAP</type>
					<key>db[current_scn]</key>
					<delay>0</delay>
					<history>1w</history>
					<description>system change delta, useful for activity comparisons</description>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>MATCHES_REGEX</type>
							<params>^[1-9][0-9]*$</params>
							<error_handler>DISCARD_VALUE</error_handler>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{max(2m,{$ZBXDB_SCN_INCREASE})}=
{last(0)}</expression>
							<name>no SCN increase since {$ZBXDB_SCN_INCREASE}</name>
							<priority>HIGH</priority>
							<description>SCN's are not increasing since {$ZBXDB_SCN_INCREASE}. Is this a standby database? Check redo transport and redo apply.</description>
							<dependencies>
								<dependency>
									<name>zbxdb Connect nodata {HOSTNAME} since {$ZBXDB_NODATA}</name>
									<expression>{template zbxDB:zbxdb[uptime].nodata({$ZBXDB_NODATA})}&lt;&gt;0</expression>
								</dependency>
								<dependency>
									<name>zbxdb Connect {HOSTNAME} failed</name>
									<expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=0</expression>
								</dependency>
							</dependencies>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>db[delta_scn]</name>
					<type>TRAP</type>
					<key>db[delta_scn]</key>
					<delay>0</delay>
					<history>1w</history>
					<value_type>FLOAT</value_type>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>CHANGE_PER_SECOND</type>
							<params/>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>db[filesize]</name>
					<type>TRAP</type>
					<key>db[filesize]</key>
					<delay>0</delay>
					<history>7d</history>
					<units>B</units>
					<description>total db  size</description>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
				</item>
				<item>
					<name>db[last_patch_hist]</name>
					<type>TRAP</type>
					<key>db[last_patch_hist]</key>
					<delay>0</delay>
					<history>100w</history>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<description>last patch action in the registry</description>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>db[usedbytes]</name>
					<type>TRAP</type>
					<key>db[usedbytes]</key>
					<delay>0</delay>
					<history>7d</history>
					<units>B</units>
					<description>total allocated size</description>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
				</item>
				<item>
					<name>disks[cached]</name>
					<type>TRAP</type>
					<key>disks[cached]</key>
					<delay>0</delay>
					<history>1w</history>
					<applications>
						<application>
							<name>ASM</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>disks[count]</name>
					<type>TRAP</type>
					<key>disks[count]</key>
					<delay>0</delay>
					<history>1w</history>
					<applications>
						<application>
							<name>ASM</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>fra[files]</name>
					<type>TRAP</type>
					<key>fra[files]</key>
					<delay>0</delay>
					<history>1w</history>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>fra[limit]</name>
					<type>TRAP</type>
					<key>fra[limit]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>B</units>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>fra[reclaimable]</name>
					<type>TRAP</type>
					<key>fra[reclaimable]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>B</units>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>fra[usable_pct]</name>
					<type>TRAP</type>
					<key>fra[usable,pct]</key>
					<delay>0</delay>
					<history>1w</history>
					<value_type>FLOAT</value_type>
					<units>%</units>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{timeleft(1h,,0)}&lt;4h</expression>
							<name>fra loop snel vol(&lt;4h)</name>
							<priority>AVERAGE</priority>
							<description>Estimated 4 hours left before depletion (based on last 6h)</description>
							<dependencies>
								<dependency>
									<name>fra zit vol</name>
									<expression>{template zbxDB:fra[usable,pct].last()}&lt;2</expression>
								</dependency>
							</dependencies>
						</trigger>
						<trigger>
							<expression>{last()}&lt;2</expression>
							<name>fra zit vol</name>
							<priority>DISASTER</priority>
							<description>Fra has less than 2% usable space</description>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>fra[used]</name>
					<type>TRAP</type>
					<key>fra[used]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>B</units>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>full_version</name>
					<type>TRAP</type>
					<key>full_version</key>
					<delay>0</delay>
					<history>7d</history>
					<trends>0</trends>
					<value_type>TEXT</value_type>
					<inventory_link>OS</inventory_link>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<triggers>
						<trigger>
							<expression>{diff()}=1</expression>
							<name>full version changed</name>
							<priority>INFO</priority>
							<description>database upgraded/patched</description>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>rman[bct_bytes]</name>
					<type>TRAP</type>
					<key>rman[bct,bytes]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>B</units>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>rman[bct_file]</name>
					<type>TRAP</type>
					<key>rman[bct,file]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>TEXT</value_type>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>rman[bct_status]</name>
					<type>TRAP</type>
					<key>rman[bct,status]</key>
					<delay>0</delay>
					<history>1w</history>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<valuemap>
						<name>zbxdb[bct,status]</name>
					</valuemap>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>rp</name>
					<type>TRAP</type>
					<key>rp</key>
					<delay>0</delay>
					<history>1w</history>
					<applications>
						<application>
							<name>backup</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{last()}&gt;0</expression>
							<name>rp present</name>
							<priority>INFO</priority>
							<description>Restore point present</description>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>total deadrows</name>
					<type>TRAP</type>
					<key>total.deadrows</key>
					<delay>0</delay>
					<history>7d</history>
					<applications>
						<application>
							<name>bloat</name>
						</application>
					</applications>
				</item>
				<item>
					<name>total liverows</name>
					<type>TRAP</type>
					<key>total.liverows</key>
					<delay>0</delay>
					<history>7d</history>
					<applications>
						<application>
							<name>bloat</name>
						</application>
					</applications>
				</item>
				<item>
					<name>zbxdb[config_db_driver]</name>
					<type>TRAP</type>
					<key>zbxdb[config,db_driver]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[config_db_type]</name>
					<type>TRAP</type>
					<key>zbxdb[config,db_type]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<inventory_link>MODEL</inventory_link>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[config_instance_type]</name>
					<type>TRAP</type>
					<key>zbxdb[config,instance_type]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[conn_dbversion]</name>
					<type>TRAP</type>
					<key>zbxdb[conn,dbversion]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<description>Not quite an OS but still a version</description>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[conn_db_role]</name>
					<type>TRAP</type>
					<key>zbxdb[conn,db_role]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[conn_instance_type]</name>
					<type>TRAP</type>
					<key>zbxdb[conn,instance_type]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[connect_instance_name]</name>
					<type>TRAP</type>
					<key>zbxdb[connect,instance_name]</key>
					<delay>0</delay>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<description>Instance where monitoring is connected to</description>
					<inventory_link>NAME</inventory_link>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<triggers>
						<trigger>
							<expression>{change()}=1
and
{nodata(1h)}=0</expression>
							<name>zbxdb[connect,instance_name] changed</name>
							<priority>INFO</priority>
							<description>connected to other instance since previous logon
after 1 hour clear message</description>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>zbxdb[connect_status]</name>
					<type>TRAP</type>
					<key>zbxdb[connect,status]</key>
					<delay>0</delay>
					<history>3d</history>
					<trends>0</trends>
					<value_type>CHAR</value_type>
					<description>0 is OK, all others is ERROR_CODE for connect</description>
					<applications>
						<application>
							<name>db</name>
						</application>
					</applications>
					<valuemap>
						<name>zbxdb[connect,status]</name>
					</valuemap>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1h</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{iregexp(^00*$)}=0</expression>
							<name>zbxdb Connect {HOSTNAME} failed</name>
							<priority>WARNING</priority>
							<description>Connect to database failed. Could be any thing from listener down to database down, account locked etc. Only 0 is OK
A short disconnect can happen .... not a real problem.</description>
							<dependencies>
								<dependency>
									<name>zbxdb connect {HOSTNAME} failed &gt;{$ZBXDB_CONNECT_FAILED}</name>
									<expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=0
and {template zbxDB:zbxdb[connect,status].nodata({$ZBXDB_CONNECT_FAILED})} = 1</expression>
									<recovery_expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=1</recovery_expression>
								</dependency>
							</dependencies>
						</trigger>
						<trigger>
							<expression>{iregexp(^00*$)}=0 
and 
{nodata(1h)} = 1</expression>
							<recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
							<recovery_expression>{iregexp(^00*$)}=1</recovery_expression>
							<name>zbxdb connect {HOSTNAME} failed &gt; 1h</name>
							<priority>HIGH</priority>
							<description>Database still not reachable

BTW: nodata because of dedup in preprocessing</description>
						</trigger>
						<trigger>
							<expression>{iregexp(^00*$)}=0
and {nodata({$ZBXDB_CONNECT_FAILED})} = 1</expression>
							<recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
							<recovery_expression>{iregexp(^00*$)}=1</recovery_expression>
							<name>zbxdb connect {HOSTNAME} failed &gt;{$ZBXDB_CONNECT_FAILED}</name>
							<priority>AVERAGE</priority>
							<description>failed {$ZBXDB_CONNECT_FAILED} ago and still fails.

BTW: nodata because of dedup in preprocessing</description>
							<dependencies>
								<dependency>
									<name>zbxdb connect {HOSTNAME} failed &gt; 1h</name>
									<expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=0 
and 
{template zbxDB:zbxdb[connect,status].nodata(1h)} = 1</expression>
									<recovery_expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=1</recovery_expression>
								</dependency>
							</dependencies>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>zbxdb[cpu_sys]</name>
					<type>TRAP</type>
					<key>zbxdb[cpu,sys]</key>
					<delay>0</delay>
					<history>1w</history>
					<value_type>FLOAT</value_type>
					<units>s</units>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[cpu_user]</name>
					<type>TRAP</type>
					<key>zbxdb[cpu,user]</key>
					<delay>0</delay>
					<history>1w</history>
					<value_type>FLOAT</value_type>
					<units>s</units>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{change(0)}&lt;0</expression>
							<name>zbxdb restarted</name>
							<priority>INFO</priority>
							<description>for some reason zbxdb has been restarted. Could be because of upgrade or server restart. Should be very, very infrequent. Check logs for reason.
make this trigger depend from the host restart to prevent a gazillion events when this happens</description>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>zbxdb[mem_maxrss]</name>
					<type>TRAP</type>
					<key>zbxdb[mem,maxrss]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>B</units>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[opentime]</name>
					<type>TRAP</type>
					<key>zbxdb[opentime]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>uptime</units>
					<description>time since db connection opened</description>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[query___ela]</name>
					<type>TRAP</type>
					<key>zbxdb[query,,,ela]</key>
					<delay>0</delay>
					<history>1w</history>
					<trends>30d</trends>
					<value_type>FLOAT</value_type>
					<units>s</units>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
				</item>
				<item>
					<name>zbxdb[uptime]</name>
					<type>TRAP</type>
					<key>zbxdb[uptime]</key>
					<delay>0</delay>
					<history>1w</history>
					<units>uptime</units>
					<description>uptime of the zbxdb process</description>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<request_method>POST</request_method>
					<triggers>
						<trigger>
							<expression>{nodata({$ZBXDB_NODATA_HIGH})}&lt;&gt;0</expression>
							<name>zbxdb Connect nodata {HOSTNAME} since {$ZBXDB_NODATA_HIGH}</name>
							<priority>HIGH</priority>
                            <description>Possibly some hang in the datbase. Blocking sessions that is/are also blocking zbxdb. Check latest data blocked[topsid] the blocker could be shown there. Does sometimes happen after a cancelled query. In that case also check the zbxdb session in the database.</description>
							<tags>
								<tag>
									<tag>MONITORED_BY_PROXY</tag>
									<value>{$MONITORED_BY_PROXY}</value>
								</tag>
							</tags>
						</trigger>
						<trigger>
							<expression>{nodata({$ZBXDB_NODATA})}&lt;&gt;0</expression>
							<name>zbxdb Connect nodata {HOSTNAME} since {$ZBXDB_NODATA}</name>
							<priority>AVERAGE</priority>
							<description>no info received during a long period</description>
							<dependencies>
								<dependency>
									<name>zbxdb Connect nodata {HOSTNAME} since {$ZBXDB_NODATA_HIGH}</name>
									<expression>{template zbxDB:zbxdb[uptime].nodata({$ZBXDB_NODATA_HIGH})}&lt;&gt;0</expression>
								</dependency>
							</dependencies>
							<tags>
								<tag>
									<tag>MONITORED_BY_PROXY</tag>
									<value>{$MONITORED_BY_PROXY}</value>
								</tag>
							</tags>
						</trigger>
					</triggers>
				</item>
				<item>
					<name>zbxdb[version]</name>
					<type>TRAP</type>
					<key>zbxdb[version]</key>
					<delay>0</delay>
					<history>1w</history>
					<value_type>FLOAT</value_type>
					<inventory_link>SOFTWARE_APP_A</inventory_link>
					<applications>
						<application>
							<name>zbxdb</name>
						</application>
					</applications>
					<preprocessing>
						<step>
							<type>DISCARD_UNCHANGED_HEARTBEAT</type>
							<params>1d</params>
						</step>
					</preprocessing>
					<request_method>POST</request_method>
				</item>
			</items>
			<discovery_rules>
				<discovery_rule>
					<name>acfs</name>
					<type>TRAP</type>
					<key>acfs.lld</key>
					<delay>0</delay>
					<description>ASM Cluster VolumeGroups</description>
					<item_prototypes>
						<item_prototype>
							<name>acfs[{#ASMVOL}_pct_free]</name>
							<type>TRAP</type>
							<key>acfs[{#ASMVOL},pct_free]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>ASMVG</name>
								</application>
							</applications>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{timeleft(14d,0,0)}&lt;14d or {timeleft(7d,0,0)}&lt;14d</expression>
									<name>asmVG {#ASMVOL} loopt binnen 14d vol</name>
									<description>Estimated to fill up within 14 days, based on last 14 or last 7 days of history.</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>acfs[{#ASMVOL}_total_mb]</name>
							<type>TRAP</type>
							<key>acfs[{#ASMVOL},total_mb]</key>
							<delay>0</delay>
							<units>B</units>
							<applications>
								<application>
									<name>ASMVG</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>MULTIPLIER</type>
									<params>1048576</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>acfs[{#ASMVOL}_used_mb]</name>
							<type>TRAP</type>
							<key>acfs[{#ASMVOL},used_mb]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ASMVG</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>MULTIPLIER</type>
									<params>1048576</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>acfs_fs</name>
					<type>TRAP</type>
					<key>acfs_fs.lld</key>
					<delay>0</delay>
					<description>acfs filesystems</description>
					<item_prototypes>
						<item_prototype>
							<name>acfs_fs[{#ACFS_FS}_pct_free]</name>
							<type>TRAP</type>
							<key>acfs_fs[{#ACFS_FS},pct_free]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>ACFS</name>
								</application>
							</applications>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{timeleft(14d,0,0)}&lt;14d or {timeleft(7d,0,0)}&lt;14d</expression>
									<name>acfs fs {#ACFS_FS} loopt binnen 14d vol</name>
									<priority>WARNING</priority>
									<description>Estimated to full up within 14 days, based on last 14 days or last 7 days of history.</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>acfs_fs[{#ACFS_FS}_total_mb]</name>
							<type>TRAP</type>
							<key>acfs_fs[{#ACFS_FS},total_mb]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ACFS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>MULTIPLIER</type>
									<params>1048567</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>acfs_fs[{#ACFS_FS}_used_mb]</name>
							<type>TRAP</type>
							<key>acfs_fs[{#ACFS_FS},used_mb]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ACFS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>MULTIPLIER</type>
									<params>1048576</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>arl_dest.lld</name>
					<type>TRAP</type>
					<key>arl_dest.lld</key>
					<delay>0</delay>
					<description>active archive log destinations</description>
					<item_prototypes>
						<item_prototype>
							<name>arl_dest[{#INST_NAME}_{#ARL_DEST}_error]</name>
							<type>TRAP</type>
							<key>arl_dest[{#INST_NAME},{#ARL_DEST},error]</key>
							<delay>0</delay>
							<trends>0</trends>
							<value_type>TEXT</value_type>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>arl_dest[{#INST_NAME}_{#ARL_DEST}_sequence]</name>
							<type>TRAP</type>
							<key>arl_dest[{#INST_NAME},{#ARL_DEST},sequence]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>arl_dest[{#INST_NAME}_{#ARL_DEST}_status]</name>
							<type>TRAP</type>
							<key>arl_dest[{#INST_NAME},{#ARL_DEST},status]</key>
							<delay>0</delay>
							<history>1w</history>
							<description>archive destination status</description>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<valuemap>
								<name>zbxdb arl_dest</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last(30m)}&gt;1</expression>
									<name>arl_dest[{#INST_NAME},{#ARL_DEST}] ! VALID</name>
									<priority>HIGH</priority>
									<description>ARL destination not in (VALID(0) and DEFERRED(1))</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>dbnames</name>
					<type>TRAP</type>
					<key>db.lld</key>
					<delay>0</delay>
					<item_prototypes>
						<item_prototype>
							<name>db[{#PDB} CPU_utilization]</name>
							<type>TRAP</type>
							<key>db[{#PDB},CPU_utilization]</key>
							<delay>0</delay>
							<history>7d</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>performance</name>
								</application>
							</applications>
						</item_prototype>
						<item_prototype>
							<name>db[{#PDB} deadrows]</name>
							<type>TRAP</type>
							<key>db[{#PDB},deadrows]</key>
							<delay>0</delay>
							<history>7d</history>
							<applications>
								<application>
									<name>bloat</name>
								</application>
							</applications>
						</item_prototype>
						<item_prototype>
							<name>db[{#PDB} liverows]</name>
							<type>TRAP</type>
							<key>db[{#PDB},liverows]</key>
							<delay>0</delay>
							<history>7d</history>
							<applications>
								<application>
									<name>bloat</name>
								</application>
							</applications>
						</item_prototype>
						<item_prototype>
							<name>{#PDB} openstatus</name>
							<type>TRAP</type>
							<key>db[{#PDB},openstatus]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>db</name>
								</application>
							</applications>
							<valuemap>
								<name>zbxdb db.openstatus</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1h</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{delta(10m)}&lt;&gt;0
and
{nodata(10m)}=0</expression>
									<name>db[{#PDB},openstatus] changed</name>
									<priority>INFO</priority>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}=1</expression>
									<name>db{#PDB} in mount mode</name>
									<priority>WARNING</priority>
									<description>PDB is mounted</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>db[{#PDB} slavestatus]</name>
							<type>TRAP</type>
							<key>db[{#PDB},slavestatus]</key>
							<delay>0</delay>
							<history>1w</history>
							<description>0: all secondary databases are healthy
&lt;42 # of secondary databases that  are not healthy
&gt;=42 at least one db is not in ha group</description>
							<applications>
								<application>
									<name>ha</name>
								</application>
							</applications>
							<valuemap>
								<name>zbxdb_ms_Hadr</name>
							</valuemap>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last()}=42</expression>
									<name>db[{#PDB}] missing slave[s] in HA group</name>
									<priority>AVERAGE</priority>
									<description>at least 1 slave is not in the AV group</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}&lt;&gt;0 and
{last()}&lt;&gt; 13</expression>
									<name>db[{#PDB}] slave sync status not healthy</name>
									<status>DISABLED</status>
									<priority>WARNING</priority>
									<description>shows the # of slaves with  problems for this primary</description>
									<dependencies>
										<dependency>
											<name>db[{#PDB}] missing slave[s] in HA group</name>
											<expression>{template zbxDB:db[{#PDB},slavestatus].last()}=42</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>ASM dgroups</name>
					<type>TRAP</type>
					<key>dgrp.lld</key>
					<delay>0</delay>
					<description>ASM disk groups
https://prutser.wordpress.com/2013/01/03/demystifying-asm-required_mirror_free_mb-and-usable_file_mb/</description>
					<item_prototypes>
						<item_prototype>
							<name>dgrp[{#DGRP}_filesize]</name>
							<type>TRAP</type>
							<key>dgrp[{#DGRP},filesize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>MULTIPLIER</type>
									<params>1048576</params>
								</step>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP},leftfree7d]</name>
							<type>CALCULATED</type>
							<key>dgrp[{#DGRP},leftfree7d]</key>
							<delay>1h</delay>
							<history>1w</history>
							<units>s</units>
							<params>timeleft(&quot;dgrp[{#DGRP},pctfree]&quot;,7d,,0)</params>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP}_leftfree14d]</name>
							<type>CALCULATED</type>
							<key>dgrp[{#DGRP},leftfree14d]</key>
							<delay>12h</delay>
							<history>1w</history>
							<units>s</units>
							<params>timeleft(&quot;dgrp[{#DGRP},pctfree]&quot;,14d,,0)</params>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP}_leftfree30d]</name>
							<type>CALCULATED</type>
							<key>dgrp[{#DGRP},leftfree30d]</key>
							<delay>1d</delay>
							<history>1w</history>
							<units>s</units>
							<params>timeleft(&quot;dgrp[{#DGRP},pctfree]&quot;,30d,,0)</params>
							<description>time left to fill up based on last 30 days.</description>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP}_leftfree180d]</name>
							<type>CALCULATED</type>
							<key>dgrp[{#DGRP},leftfree180d]</key>
							<delay>1d</delay>
							<history>1w</history>
							<units>s</units>
							<params>timeleft(&quot;dgrp[{#DGRP},pctfree]&quot;,180d,,0)</params>
							<description>time left to fill up, based on last 180 days.</description>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP}_pctfree]</name>
							<type>TRAP</type>
							<key>dgrp[{#DGRP},pctfree]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last(0)}&lt;{$ZBXDB_ASM_PCTFREE_HIGH} and {min(12h,7d)}-{last(0)}&gt;0</expression>
									<name>dg[{#DGRP},pctfree] &lt; {$ZBXDB_ASM_PCTFREE_HIGH}</name>
									<priority>HIGH</priority>
									<description>low space and changed in last week</description>
									<dependencies>
										<dependency>
											<name>dg[{#DGRP},pctfree] == 0</name>
											<expression>{template zbxDB:dgrp[{#DGRP},pctfree].last()}=0</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last(0)}&lt; {$ZBXDB_ASM_PCTFREE_INFO} and {min(1d,7d)}-{last(0)}&gt;0</expression>
									<name>dg[{#DGRP},pctfree] &lt; {$ZBXDB_ASM_PCTFREE_INFO}</name>
									<priority>INFO</priority>
									<description>low space and changing</description>
									<dependencies>
										<dependency>
											<name>dg[{#DGRP},pctfree] &lt; {$ZBXDB_ASM_PCTFREE_WARN}</name>
											<expression>{template zbxDB:dgrp[{#DGRP},pctfree].last(0)}&lt; {$ZBXDB_ASM_PCTFREE_WARN} and 
{template zbxDB:dgrp[{#DGRP},pctfree].min(24h,7d)}&gt;
{template zbxDB:dgrp[{#DGRP},pctfree].last(0)}</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last(0)}&lt; {$ZBXDB_ASM_PCTFREE_WARN} and 
{min(24h,7d)}&gt;
{last(0)}</expression>
									<name>dg[{#DGRP},pctfree] &lt; {$ZBXDB_ASM_PCTFREE_WARN}</name>
									<priority>WARNING</priority>
									<description>pct free &lt; warning level and
current pct free &lt; minimum pct free of a week ago</description>
									<dependencies>
										<dependency>
											<name>dg[{#DGRP},pctfree] &lt; {$ZBXDB_ASM_PCTFREE_HIGH}</name>
											<expression>{template zbxDB:dgrp[{#DGRP},pctfree].last(0)}&lt;{$ZBXDB_ASM_PCTFREE_HIGH} and {template zbxDB:dgrp[{#DGRP},pctfree].min(12h,7d)}-{template zbxDB:dgrp[{#DGRP},pctfree].last(0)}&gt;0</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}=0</expression>
									<name>dg[{#DGRP},pctfree] == 0</name>
									<priority>DISASTER</priority>
									<description>game over</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{timeleft(14d,,0)} &lt; 100d and {timeleft(14d,,0)} &lt; 2d or {timeleft(14d,,0)} &gt;= 100d and ( {timeleft(7d,,0)} &lt; 100d and {timeleft(7d,,0)} &lt; 2d or {timeleft(7d,,0)} &gt;= 100d and ( {timeleft(1d,,0)} &lt; 100d and {timeleft(1d,,0)} &lt; 2d or {timeleft(1d,,0)} &gt;= 100d and ( {timeleft(6h,,0)} &lt; 100d and {timeleft(6h,,0)} &lt; 2d)))</expression>
									<name>dg[{#DGRP} loopt binnen 2d vol</name>
									<priority>AVERAGE</priority>
									<description>Try to warn in time despite wave pattern.
when based 
on last 14d &lt; 2d
or  last 7d &lt; 2d
or  last 1d &lt; 2d
or  last 6h &lt; 2d less than 2 days left the trigger fires.</description>
									<dependencies>
										<dependency>
											<name>dg[{#DGRP},pctfree] == 0</name>
											<expression>{template zbxDB:dgrp[{#DGRP},pctfree].last()}=0</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{timeleft(14d,,0)} &lt; 100d and {timeleft(14d,,0)} &lt; 14d or {timeleft(14d,,0)} &gt;= 100d and ( {timeleft(7d,,0)} &lt; 100d and {timeleft(7d,,0)} &lt; 14d )</expression>
									<name>dg[{#DGRP} loopt binnen 14d vol</name>
									<priority>WARNING</priority>
									<description>Try to warn in time despite wave pattern.
when based 
    on last 14d &lt; 14d
or  on last 7d &lt; 14d time left the trigger fires.</description>
									<dependencies>
										<dependency>
											<name>dg[{#DGRP} loopt binnen 2d vol</name>
											<expression>{template zbxDB:dgrp[{#DGRP},pctfree].timeleft(14d,,0)} &lt; 100d and {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(14d,,0)} &lt; 2d or {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(14d,,0)} &gt;= 100d and ( {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(7d,,0)} &lt; 100d and {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(7d,,0)} &lt; 2d or {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(7d,,0)} &gt;= 100d and ( {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(1d,,0)} &lt; 100d and {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(1d,,0)} &lt; 2d or {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(1d,,0)} &gt;= 100d and ( {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(6h,,0)} &lt; 100d and {template zbxDB:dgrp[{#DGRP},pctfree].timeleft(6h,,0)} &lt; 2d)))</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP}_usedbytes]</name>
							<type>TRAP</type>
							<key>dgrp[{#DGRP},usedbytes]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>MULTIPLIER</type>
									<params>1048576</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>dgrp[{#DGRP}_leftfree1d]</name>
							<type>CALCULATED</type>
							<key>dgrp[{#DGRP}_leftfree1d]</key>
							<delay>1h</delay>
							<history>1w</history>
							<units>s</units>
							<params>timeleft(&quot;dgrp[{#DGRP},pctfree]&quot;,1d,,0)</params>
							<applications>
								<application>
									<name>ASM</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>dgrp[{#DGRP},usage]</name>
							<graph_items>
								<graph_item>
									<color>C80000</color>
									<item>
										<host>template zbxDB</host>
										<key>dgrp[{#DGRP},filesize]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<color>00C800</color>
									<item>
										<host>template zbxDB</host>
										<key>dgrp[{#DGRP},usedbytes]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>expu.lld</name>
					<type>TRAP</type>
					<key>expu.lld</key>
					<delay>0</delay>
					<lifetime>3d</lifetime>
					<description>discover users about to expire</description>
					<item_prototypes>
						<item_prototype>
							<name>expu[{#PDB}_{#USERNAME}_expiring]</name>
							<type>TRAP</type>
							<key>expu[{#PDB},{#USERNAME},expiring]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<description>days left before expiration takes place</description>
							<applications>
								<application>
									<name>users</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last(0)}&lt; 7d and {last(0)} &gt; 0</expression>
									<name>account expiration {#PDB} {#USERNAME} in 1 week</name>
									<priority>WARNING</priority>
									<description>and {template zbxDB:expu[{#PDB},{#USERNAME},expiring].nodata(2h)}=0</description>
									<dependencies>
										<dependency>
											<name>account expiration {#PDB} {#USERNAME} in 5 days</name>
											<expression>{template zbxDB:expu[{#PDB},{#USERNAME},expiring].last(0)}&lt;5d and {template zbxDB:expu[{#PDB},{#USERNAME},expiring].last(0)} &gt; 0</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last(0)}&lt;14d and {last(0)} &gt; 0</expression>
									<name>account expiration {#PDB} {#USERNAME} in 2 weeks</name>
									<priority>INFO</priority>
									<description>acount to expire within 14 days, nodata when password has been changed.


and {template zbxDB:expu[{#PDB},#USERNAME},expiring].nodata(2h)}=0</description>
									<dependencies>
										<dependency>
											<name>account expiration {#PDB} {#USERNAME} in 1 week</name>
											<expression>{template zbxDB:expu[{#PDB},{#USERNAME},expiring].last(0)}&lt; 7d and {template zbxDB:expu[{#PDB},{#USERNAME},expiring].last(0)} &gt; 0</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last(0)}&lt;5d and {last(0)} &gt; 0</expression>
									<name>account expiration {#PDB} {#USERNAME} in 5 days</name>
									<priority>AVERAGE</priority>
									<description>when password is reset, the user is no longer reported so the reset error should be on nodata

and {template zbxDB:expu[{#PDB},{#USERNAME},expiring].nodata(2h)}=0</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>features.lld</name>
					<type>TRAP</type>
					<key>features.lld</key>
					<delay>0</delay>
					<item_prototypes>
						<item_prototype>
							<name>feature[{#PDB}_{#NAME}_inuse]</name>
							<type>TRAP</type>
							<key>feature[{#PDB},{#NAME},inuse]</key>
							<delay>0</delay>
							<history>7d</history>
							<applications>
								<application>
									<name>license</name>
								</application>
							</applications>
							<valuemap>
								<name>feature usage</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
						</item_prototype>
					</item_prototypes>
				</discovery_rule>
				<discovery_rule>
					<name>inst.lld</name>
					<type>TRAP</type>
					<key>inst.lld</key>
					<delay>0</delay>
					<description>discovered instances</description>
					<item_prototypes>
						<item_prototype>
							<name>inst[{#INST_NAME} CPU_utilization]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},CPU_utilization]</key>
							<delay>0</delay>
							<history>7d</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>performance</name>
								</application>
							</applications>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_DB time]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},DB time]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>performance</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>CHANGE_PER_SECOND</type>
									<params/>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_execute count]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},execute count]</key>
							<delay>0</delay>
							<history>1w</history>
							<description>number of executions, could be server call's, could be sql's ..... just to give an idea about what is happening over time</description>
							<applications>
								<application>
									<name>inst.perf</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>CHANGE_PER_SECOND</type>
									<params/>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_log]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},log]</key>
							<delay>0</delay>
							<history>10d</history>
							<trends>0</trends>
							<value_type>TEXT</value_type>
							<description>alert log name</description>
							<applications>
								<application>
									<name>inst</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_processes]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},processes]</key>
							<delay>0</delay>
							<history>1w</history>
							<description># of processes in use, should be less than processes parameter</description>
							<applications>
								<application>
									<name>inst</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_sessions]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},sessions]</key>
							<delay>0</delay>
							<history>1w</history>
							<description>sessions count</description>
							<applications>
								<application>
									<name>inst</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_uptime]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},uptime]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>uptime</units>
							<description>time since instance opened</description>
							<applications>
								<application>
									<name>inst</name>
								</application>
							</applications>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{nodata({$ZBXDB_NODATA})}&lt;&gt;0</expression>
									<name>{HOST.NAME} {#INST_NAME} not responding since {$ZBXDB_NODATA}</name>
									<priority>WARNING</priority>
									<description>could be down but could also be caused when no parallel slaves are available in the remote instance[s]</description>
									<manual_close>YES</manual_close>
									<dependencies>
										<dependency>
											<name>zbxdb Connect nodata {HOSTNAME} since {$ZBXDB_NODATA}</name>
											<expression>{template zbxDB:zbxdb[uptime].nodata({$ZBXDB_NODATA})}&lt;&gt;0</expression>
										</dependency>
										<dependency>
											<name>zbxdb Connect {HOSTNAME} failed</name>
											<expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=0</expression>
										</dependency>
									</dependencies>
									<tags>
										<tag>
											<tag>MONITORED_BY_PROXY</tag>
											<value>{$MONITORED_BY_PROXY}</value>
										</tag>
									</tags>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{change(0)}&lt;-60</expression>
									<name>{HOST.NAME} {#INST_NAME} restarted</name>
									<priority>INFO</priority>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_user calls]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},user calls]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>inst.perf</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>CHANGE_PER_SECOND</type>
									<params/>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>inst[{#INST_NAME}_version]</name>
							<type>TRAP</type>
							<key>inst[{#INST_NAME},version]</key>
							<delay>0</delay>
							<history>100w</history>
							<trends>0</trends>
							<value_type>CHAR</value_type>
							<description>version info is only collected at connection time (minutes=0) so only a few samples.</description>
							<applications>
								<application>
									<name>inst</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>inst[{#INST_NAME},uptime</name>
							<graph_items>
								<graph_item>
									<color>00C800</color>
									<item>
										<host>template zbxDB</host>
										<key>inst[{#INST_NAME},uptime]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>jobs.lld</name>
					<type>TRAP</type>
					<key>jobs.lld</key>
					<delay>0</delay>
					<lifetime>7d</lifetime>
					<item_prototypes>
						<item_prototype>
							<name>job[{#JOBNAME}_age]</name>
							<type>TRAP</type>
							<key>job[{#JOBNAME},age]</key>
							<delay>0</delay>
							<history>7d</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<applications>
								<application>
									<name>jobs</name>
								</application>
							</applications>
						</item_prototype>
						<item_prototype>
							<name>job[{#JOBNAME}_enabled]</name>
							<type>TRAP</type>
							<key>job[{#JOBNAME},enabled]</key>
							<delay>0</delay>
							<history>7d</history>
							<applications>
								<application>
									<name>jobs</name>
								</application>
							</applications>
							<valuemap>
								<name>job enabled</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
						</item_prototype>
						<item_prototype>
							<name>job[{#JOBNAME}_status]</name>
							<type>TRAP</type>
							<key>job[{#JOBNAME},status]</key>
							<delay>0</delay>
							<history>7d</history>
							<value_type>FLOAT</value_type>
							<applications>
								<application>
									<name>jobs</name>
								</application>
							</applications>
							<valuemap>
								<name>job status</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last()}&lt;&gt;1 and
{last()}&lt;&gt;4 and
{last()}&lt;&gt;-1</expression>
									<name>job {#JOBNAME} not succeeded</name>
									<priority>WARNING</priority>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
				</discovery_rule>
				<discovery_rule>
					<name>parm.lld</name>
					<type>TRAP</type>
					<key>parm.lld</key>
					<delay>0</delay>
					<description>non default numeric parameters</description>
					<item_prototypes>
						<item_prototype>
							<name>parm[{#INST_NAME}_{#PARAMETER}_size]</name>
							<type>TRAP</type>
							<key>parm[{#INST_NAME},{#PARAMETER},size]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>B</units>
							<applications>
								<application>
									<name>inst.parm</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{change(0)}&lt;&gt;0</expression>
									<name>parm[{#INST_NAME},{#PARAMETER}] changed to {ITEM.LASTVALUE}</name>
									<priority>INFO</priority>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>parm[{#INST_NAME}_{#PARAMETER}_value]</name>
							<type>TRAP</type>
							<key>parm[{#INST_NAME},{#PARAMETER},value]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<description>non default numeric parameters</description>
							<applications>
								<application>
									<name>inst.parm</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{change(0)}&lt;&gt;0</expression>
									<name>parm[{#INST_NAME},{#PARAMETER}] changed to {ITEM.LASTVALUE}</name>
									<priority>INFO</priority>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>perm TS</name>
					<type>TRAP</type>
					<key>p_ts.lld</key>
					<delay>0</delay>
					<item_prototypes>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_filesize]</name>
							<type>TRAP</type>
							<key>p_ts[{#PDB},{#TS_NAME},filesize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>tssize</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_maxsize]</name>
							<type>TRAP</type>
							<key>p_ts[{#PDB},{#TS_NAME},maxsize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>tsmaxsize</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_pctfreeMAX_timeleft1d]</name>
							<type>CALCULATED</type>
							<key>p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft1d]</key>
							<delay>1h</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<params>timeleft(&quot;p_ts[{#PDB},{#TS_NAME},pctfreeMAX]&quot;,1d,,0)</params>
							<description>time left to depletion based on last day of measurements</description>
							<applications>
								<application>
									<name>tspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_pctfreeMAX_timeleft7d]</name>
							<type>CALCULATED</type>
							<key>p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft7d]</key>
							<delay>1h</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<params>timeleft(&quot;p_ts[{#PDB},{#TS_NAME},pctfreeMAX]&quot;,7d,,0)</params>
							<description>time to depletion based on last week of measurements</description>
							<applications>
								<application>
									<name>tspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_pctfreeMAX_timeleft14d]</name>
							<type>CALCULATED</type>
							<key>p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft14d]</key>
							<delay>1h</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<params>timeleft(&quot;p_ts[{#PDB},{#TS_NAME},pctfreeMAX]&quot;,14d,,0)</params>
							<description>time to depletion based on last 14 days of measurements</description>
							<applications>
								<application>
									<name>tspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_pctfreeMAX]</name>
							<type>TRAP</type>
							<key>p_ts[{#PDB},{#TS_NAME},pctfreeMAX]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<description>same as pctfree but based on max filesize</description>
							<applications>
								<application>
									<name>tspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{timeleft(14d,,0)} &lt; 5d or {timeleft(14d,,0)} &gt;= 100d and {timeleft(7d,,0)} &lt; 5d or {timeleft(7d,,0)} &gt;= 100d and {timeleft(1d,,0)} &lt; 2d</expression>
									<name>p_ts[{#PDB},{#TS_NAME}] loopt binnen 5d vol</name>
									<priority>AVERAGE</priority>
									<description>Tablespace fills up within 5d
based on last 14d or last 7d or last day.</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{timeleft(14d,,0)} &lt; 100d and {timeleft(14d,,0)} &lt; 14d or {timeleft(14d,,0)} &gt;= 100d and ( {timeleft(7d,,0)} &lt; 100d and {timeleft(7d,,0)} &lt; 7d or {timeleft(7d,,0)} &gt;= 100d and ( {timeleft(1d,,0)} &lt; 100d and {timeleft(1d,,0)} &lt; 1d))</expression>
									<name>p_ts[{#PDB},{#TS_NAME}] loopt binnen 14d vol</name>
									<priority>WARNING</priority>
									<description>Tablespace is filling up soon.</description>
									<dependencies>
										<dependency>
											<name>p_ts[{#PDB},{#TS_NAME}] loopt binnen 5d vol</name>
											<expression>{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].timeleft(14d,,0)} &lt; 5d or {template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].timeleft(14d,,0)} &gt;= 100d and {template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].timeleft(7d,,0)} &lt; 5d or {template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].timeleft(7d,,0)} &gt;= 100d and {template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].timeleft(1d,,0)} &lt; 2d</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_pctfree]</name>
							<type>TRAP</type>
							<key>p_ts[{#PDB},{#TS_NAME},pctfree]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>tspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>p_ts[{#PDB}_{#TS_NAME}_usedbytes]</name>
							<type>TRAP</type>
							<key>p_ts[{#PDB},{#TS_NAME},usedbytes]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>tsused</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<trigger_prototypes>
						<trigger_prototype>
							<expression>{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].last(0)}&lt; {$ZBXDB_TS_HIGH} 
and 
{template zbxDB:p_ts[{#PDB},{#TS_NAME},usedbytes].last(0)}-{template zbxDB:p_ts[{#PDB},{#TS_NAME},usedbytes].max(7d,1d)} &gt; 0</expression>
							<name>p_ts[{#PDB},{#TS_NAME},pctfreeMAX]&lt; {$ZBXDB_TS_HIGH}</name>
							<priority>HIGH</priority>
							<description>TS grows since a week and hits HIGH alert treshhold</description>
						</trigger_prototype>
						<trigger_prototype>
							<expression>{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].last(0)}&lt; {$ZBXDB_TS_WARN} and 
{template zbxDB:p_ts[{#PDB},{#TS_NAME},usedbytes].last(0)}-{template zbxDB:p_ts[{#PDB},{#TS_NAME},usedbytes].max(7d,1d)} &gt; 0</expression>
							<name>p_ts[{#PDB},{#TS_NAME},pctfreeMAX]&lt; {$ZBXDB_TS_WARN}</name>
							<priority>WARNING</priority>
							<description>TS is growing since last week and hits WARN level</description>
							<dependencies>
								<dependency>
									<name>p_ts[{#PDB},{#TS_NAME},pctfreeMAX]&lt; {$ZBXDB_TS_HIGH}</name>
									<expression>{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].last(0)}&lt; {$ZBXDB_TS_HIGH} 
and 
{template zbxDB:p_ts[{#PDB},{#TS_NAME},usedbytes].last(0)}-{template zbxDB:p_ts[{#PDB},{#TS_NAME},usedbytes].max(7d,1d)} &gt; 0</expression>
								</dependency>
							</dependencies>
						</trigger_prototype>
						<trigger_prototype>
							<expression>{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].last()}&lt;{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX].last(1)}
and
{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft1d].last()}&lt;4d
and
{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft1d].last()}&lt;{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft1d].last(1)}
and {template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft7d].last()}&lt;14d
and
{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft7d].last()}&lt;{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft7d].last(1)}
and {template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft14d].last()}&lt;30d
and
{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft14d].last()}&lt;{template zbxDB:p_ts[{#PDB},{#TS_NAME},pctfreeMAX,timeleft14d].last(1)}</expression>
							<name>p_ts[{#PDB},{#TS_NAME}] loopt vol</name>
							<description>Tablespace fills up within 4d</description>
						</trigger_prototype>
					</trigger_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>usage {#PDB}.{#TS_NAME} permament</name>
							<graph_items>
								<graph_item>
									<color>0000CC</color>
									<item>
										<host>template zbxDB</host>
										<key>p_ts[{#PDB},{#TS_NAME},filesize]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<color>009900</color>
									<item>
										<host>template zbxDB</host>
										<key>p_ts[{#PDB},{#TS_NAME},usedbytes]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>2</sortorder>
									<color>FF3333</color>
									<item>
										<host>template zbxDB</host>
										<key>p_ts[{#PDB},{#TS_NAME},maxsize]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>rman.lld</name>
					<type>TRAP</type>
					<key>rman.lld</key>
					<delay>0</delay>
					<lifetime>0</lifetime>
					<description>rman backup info by object_type from v$rman_status</description>
					<item_prototypes>
						<item_prototype>
							<name>rman[{#OBJ_TYPE}_age]</name>
							<type>TRAP</type>
							<key>rman[{#OBJ_TYPE},age]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>({last(0)}&gt; 
( {$ZBXDB_BKUP_AGE_FACTOR}* {avg(30d)}
)) and {$ZBXDB_BKUP_AGE_FACTOR} &gt; 0</expression>
									<name>rman bkup {#OBJ_TYPE} {$ZBXDB_BKUP_AGE_FACTOR} * older than usual avg</name>
									<priority>AVERAGE</priority>
									<description>try to report when last backup far over average age. Age is taken from last 30 days. 
Set macro $ZBXDB_BKUP_AGE_FACTOR to 0 if backups are not important for the given host.</description>
									<tags>
										<tag>
											<tag>zbxdb_backup</tag>
											<value>{HOST.NAME}</value>
										</tag>
									</tags>
								</trigger_prototype>
								<trigger_prototype>
									<expression>({min(2h)}&gt;{$ZBXDB_BKUP_MAX_INCR_AGE}) and {$ZBXDB_BKUP_AGE_FACTOR} &gt; 0</expression>
									<name>rman[{#OBJ_TYPE}].last bkup OUDer {$ZBXDB_BKUP_MAX_INCR_AGE}</name>
									<priority>AVERAGE</priority>
									<description>backups older than {$ZBXDB_BKUP_MAX_INCR_AGE} ..... 
Fires only after 2 hours to give SQL Server action scripts to run backups after a switch over.</description>
									<manual_close>YES</manual_close>
									<tags>
										<tag>
											<tag>zbxdb_backup</tag>
											<value>{HOST.NAME}</value>
										</tag>
									</tags>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>rman[{#OBJ_TYPE}_ela]</name>
							<type>TRAP</type>
							<key>rman[{#OBJ_TYPE},ela]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>s</units>
							<description>elapsed time for this backup</description>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>rman[{#OBJ_TYPE}_input]</name>
							<type>TRAP</type>
							<key>rman[{#OBJ_TYPE},input]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>rman[{#OBJ_TYPE}_output]</name>
							<type>TRAP</type>
							<key>rman[{#OBJ_TYPE},output]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>rman[{#OBJ_TYPE}_status]</name>
							<type>TRAP</type>
							<key>rman[{#OBJ_TYPE},status]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>backup</name>
								</application>
							</applications>
							<valuemap>
								<name>zbxdb rman status</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>({last(0)}=1 or {last(0)}=3) 

and {$ZBXDB_BKUP_AGE_FACTOR} &gt; 0</expression>
									<name>rman[{#OBJ_TYPE}].last bkup failed</name>
									<priority>WARNING</priority>
									<description>set macro {$ZBXDB_BKUP_AGE_FACTOR} to 0 when backups are not of any importance.

Trigger fires immdiatly, not sent to standby: not fatal</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
					<trigger_prototypes>
						<trigger_prototype>
							<expression>{template zbxDB:rman[{#OBJ_TYPE},status].last()}=5
and
(
({template zbxDB:rman[{#OBJ_TYPE},ela].last()}*10)&gt;({template zbxDB:rman[{#OBJ_TYPE},ela].max(2d,6d)}*15)
)</expression>
							<name>rman[{#OBJ_TYPE}] running longer than a  week  ago</name>
							<priority>INFO</priority>
							<description>status 5 == running
Running much longer than earlier</description>
						</trigger_prototype>
					</trigger_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>rman {#OBJ_TYPE}</name>
							<graph_items>
								<graph_item>
									<color>00C800</color>
									<item>
										<host>template zbxDB</host>
										<key>rman[{#OBJ_TYPE},age]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<color>C80000</color>
									<calc_fnc>MAX</calc_fnc>
									<item>
										<host>template zbxDB</host>
										<key>rman[{#OBJ_TYPE},age]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>2</sortorder>
									<color>0000C8</color>
									<item>
										<host>template zbxDB</host>
										<key>rman[{#OBJ_TYPE},ela]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>schema.lld</name>
					<type>TRAP</type>
					<key>schema.lld</key>
					<delay>0</delay>
					<description>all schema's in all databases</description>
					<item_prototypes>
						<item_prototype>
							<name>objects[{#PDB}_{#SCHEMA}_INVALID_count]</name>
							<type>TRAP</type>
							<key>objects[{#PDB},{#SCHEMA},INVALID,count]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>objects</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{change()}&gt;0</expression>
									<name>objects[{#PDB},{#SCHEMA},INVALID,count] increased</name>
									<status>DISABLED</status>
									<priority>INFO</priority>
									<description>invalid objects should not exist but certainly not increase</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>objects[{#PDB}_{#SCHEMA}_VALID_count]</name>
							<type>TRAP</type>
							<key>objects[{#PDB},{#SCHEMA},VALID,count]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>objects</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>services</name>
					<type>TRAP</type>
					<key>service.lld</key>
					<delay>0</delay>
					<description>database service definitions</description>
					<item_prototypes>
						<item_prototype>
							<name>service[{#PDB}_{#INST_NAME}_{#SERVICE_NAME}_sess]</name>
							<type>TRAP</type>
							<key>service[{#PDB},{#INST_NAME},{#SERVICE_NAME},sess]</key>
							<delay>0</delay>
							<history>1w</history>
							<description>Sessions counted by database, instance, service.</description>
							<applications>
								<application>
									<name>inst</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>service[{#PDB},{#INST_NAME},{#SERVICE_NAME} sessions</name>
							<graph_items>
								<graph_item>
									<color>1A7C11</color>
									<item>
										<host>template zbxDB</host>
										<key>service[{#PDB},{#INST_NAME},{#SERVICE_NAME},sess]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>temp TS</name>
					<type>TRAP</type>
					<key>t_ts.lld</key>
					<delay>0</delay>
					<item_prototypes>
						<item_prototype>
							<name>t_ts[{#PDB}_{#TS_NAME}_filesize]</name>
							<type>TRAP</type>
							<key>t_ts[{#PDB},{#TS_NAME},filesize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ttssize</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>t_ts[{#PDB}_{#TS_NAME}_maxsize]</name>
							<type>TRAP</type>
							<key>t_ts[{#PDB},{#TS_NAME},maxsize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ttsmaxsize</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>t_ts[{#PDB}_{#TS_NAME}_pctfreeMAX]</name>
							<type>TRAP</type>
							<key>t_ts[{#PDB},{#TS_NAME},pctfreeMAX]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<description>same as pctfree but based on max filesize</description>
							<applications>
								<application>
									<name>ttspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>t_ts[{#PDB}_{#TS_NAME}_pctfree]</name>
							<type>TRAP</type>
							<key>t_ts[{#PDB},{#TS_NAME},pctfree]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>ttspctfree</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last(0)}&lt;2</expression>
									<name>t_ts[{#PDB},{#TS_NAME},pctfree] &lt; $1</name>
									<priority>AVERAGE</priority>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last(0)}&lt;5</expression>
									<name>t_ts[{#PDB},{#TS_NAME},pctfree] &lt; $1</name>
									<priority>WARNING</priority>
									<dependencies>
										<dependency>
											<name>t_ts[{#PDB},{#TS_NAME},pctfree] &lt; $1</name>
											<expression>{template zbxDB:t_ts[{#PDB},{#TS_NAME},pctfree].last(0)}&lt;2</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>t_ts[{#PDB}_{#TS_NAME}_usedbytes]</name>
							<type>TRAP</type>
							<key>t_ts[{#PDB},{#TS_NAME},usedbytes]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>ttsused</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>usage {#PDB}.{#TS_NAME} temp</name>
							<graph_items>
								<graph_item>
									<color>00C800</color>
									<item>
										<host>template zbxDB</host>
										<key>t_ts[{#PDB},{#TS_NAME},filesize]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<color>C80000</color>
									<item>
										<host>template zbxDB</host>
										<key>t_ts[{#PDB},{#TS_NAME},usedbytes]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>ustat.lld</name>
					<type>TRAP</type>
					<key>ustat.lld</key>
					<delay>0</delay>
					<description>counts per database per account_status</description>
					<item_prototypes>
						<item_prototype>
							<name>ustat[{#PDB}_{#STATUS}_count]</name>
							<type>TRAP</type>
							<key>ustat[{#PDB},{#STATUS},count]</key>
							<delay>0</delay>
							<history>1w</history>
							<description>count per account_status</description>
							<applications>
								<application>
									<name>users</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>undo TS</name>
					<type>TRAP</type>
					<key>u_ts.lld</key>
					<delay>0</delay>
					<lifetime>1w</lifetime>
					<item_prototypes>
						<item_prototype>
							<name>u_ts[{#PDB}_{#TS_NAME}_filesize]</name>
							<type>TRAP</type>
							<key>u_ts[{#PDB},{#TS_NAME},filesize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>undoTS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>u_ts[{#PDB}_{#TS_NAME}_maxsize]</name>
							<type>TRAP</type>
							<key>u_ts[{#PDB},{#TS_NAME},maxsize]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>undoTS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>u_ts[{#PDB}_{#TS_NAME}_pctfreeMAX]</name>
							<type>TRAP</type>
							<key>u_ts[{#PDB},{#TS_NAME},pctfreeMAX]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<description>same as pctfree but based on max filesize</description>
							<applications>
								<application>
									<name>undoTS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last(0)}&lt; {$ZBXDB_TS_HIGH}</expression>
									<name>u_ts[{#PDB},{#TS_NAME},pctfreeMAX]&lt; {$ZBXDB_TS_HIGH}</name>
									<priority>HIGH</priority>
									<description>undo tablespace almost FULL</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last(0)}&lt; {$ZBXDB_TS_WARN}</expression>
									<name>u_ts[{#PDB},{#TS_NAME},pctfreeMAX]&lt; {$ZBXDB_TS_WARN}</name>
									<priority>AVERAGE</priority>
									<description>undo tablespace almost filled up</description>
									<dependencies>
										<dependency>
											<name>u_ts[{#PDB},{#TS_NAME},pctfreeMAX]&lt; {$ZBXDB_TS_HIGH}</name>
											<expression>{template zbxDB:u_ts[{#PDB},{#TS_NAME},pctfreeMAX].last(0)}&lt; {$ZBXDB_TS_HIGH}</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
						<item_prototype>
							<name>u_ts[{#PDB}_{#TS_NAME}_pctfree]</name>
							<type>TRAP</type>
							<key>u_ts[{#PDB},{#TS_NAME},pctfree]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>%</units>
							<applications>
								<application>
									<name>undoTS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>u_ts[{#PDB}_{#TS_NAME}_usedbytes]</name>
							<type>TRAP</type>
							<key>u_ts[{#PDB},{#TS_NAME},usedbytes]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>B</units>
							<applications>
								<application>
									<name>undoTS</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<graph_prototypes>
						<graph_prototype>
							<name>usage {#PDB}.{#TS_NAME} undo</name>
							<graph_items>
								<graph_item>
									<color>00C800</color>
									<item>
										<host>template zbxDB</host>
										<key>u_ts[{#PDB},{#TS_NAME},filesize]</key>
									</item>
								</graph_item>
								<graph_item>
									<sortorder>1</sortorder>
									<color>C80000</color>
									<item>
										<host>template zbxDB</host>
										<key>u_ts[{#PDB},{#TS_NAME},usedbytes]</key>
									</item>
								</graph_item>
							</graph_items>
						</graph_prototype>
					</graph_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>zbxdb.files</name>
					<type>TRAP</type>
					<key>zbxdb.files.lld</key>
					<delay>0</delay>
					<description>Which files are in use?</description>
					<item_prototypes>
						<item_prototype>
							<name>zbxdb[checks_{#CHECKS_FILE}_lmod]</name>
							<type>TRAP</type>
							<key>zbxdb[checks,{#CHECKS_FILE},lmod]</key>
							<delay>0</delay>
							<history>1w</history>
							<units>unixtime</units>
							<description>last modification date of the #CHECKS_FILE</description>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>zbxdb[checks_{#CHECKS_FILE}_name]</name>
							<type>TRAP</type>
							<key>zbxdb[checks,{#CHECKS_FILE},name]</key>
							<delay>0</delay>
							<history>30d</history>
							<trends>0</trends>
							<value_type>CHAR</value_type>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>zbxdb[checks_{#CHECKS_FILE}_status]</name>
							<type>TRAP</type>
							<key>zbxdb[checks,{#CHECKS_FILE},status]</key>
							<delay>0</delay>
							<history>1w</history>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<valuemap>
								<name>zbxdb[checks,status]</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>zbxdb queries</name>
					<type>TRAP</type>
					<key>zbxdb.query.lld</key>
					<delay>0</delay>
					<lifetime>1d</lifetime>
					<description>queries found in the zbxdb checks file</description>
					<item_prototypes>
						<item_prototype>
							<name>query[{#SECTION}_{#KEY}_ela]</name>
							<type>TRAP</type>
							<key>zbxdb[query,{#SECTION},{#KEY},ela]</key>
							<delay>0</delay>
							<history>1w</history>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<description>part of self health check; how long takes processing of a check section?</description>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>query[{#SECTION}_{#KEY}_fetch] time</name>
							<type>TRAP</type>
							<key>zbxdb[query,{#SECTION},{#KEY},fetch]</key>
							<delay>0</delay>
							<history>1w</history>
							<trends>30d</trends>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
						<item_prototype>
							<name>query[{#SECTION}_{#KEY}_status]</name>
							<type>TRAP</type>
							<key>zbxdb[query,{#SECTION},{#KEY},status]</key>
							<delay>0</delay>
							<history>3d</history>
							<trends>0</trends>
							<value_type>CHAR</value_type>
							<description>status of query execution, part of self health check
0 == OK, all others ERROR_CODE from database</description>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<valuemap>
								<name>zbxdb[query,,,status]</name>
							</valuemap>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
							<trigger_prototypes>
								<trigger_prototype>
									<expression>{last(0)}&lt;&gt;0</expression>
									<name>zbxdb[query,{#SECTION},{#KEY}] failed</name>
									<description>could be due to anything, query syntax, lost connection, permissions etc.</description>
									<dependencies>
										<dependency>
											<name>zbxdb Connect {HOSTNAME} failed</name>
											<expression>{template zbxDB:zbxdb[connect,status].iregexp(^00*$)}=0</expression>
										</dependency>
										<dependency>
											<name>zbxdb[query,{#SECTION},{#KEY}] failed ORA-12850</name>
											<expression>{template zbxDB:zbxdb[query,{#SECTION},{#KEY},status].last()}=12850</expression>
										</dependency>
										<dependency>
											<name>zbxdb[query,{#SECTION},{#KEY}] shared pool vol (4031)</name>
											<expression>{template zbxDB:zbxdb[query,{#SECTION},{#KEY},status].last()}=4031</expression>
										</dependency>
										<dependency>
											<name>zbxdb[query,{#SECTION},{#KEY}] timed out</name>
											<expression>{template zbxDB:zbxdb[query,{#SECTION},{#KEY},status].last()}=1013
or
{template zbxDB:zbxdb[query,{#SECTION},{#KEY},status].str(timeout)}=1</expression>
										</dependency>
										<dependency>
											<name>zbxdb[query,{#SECTION},{#KEY}] user canceled</name>
											<expression>{template zbxDB:zbxdb[query,{#SECTION},{#KEY},status].last()}=57014</expression>
										</dependency>
									</dependencies>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}=12850</expression>
									<name>zbxdb[query,{#SECTION},{#KEY}] failed ORA-12850</name>
									<priority>WARNING</priority>
									<description>COULD NOT ALLOCATE SLAVES ON ALL SPECIFIED INSTANCES</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}=4031</expression>
									<name>zbxdb[query,{#SECTION},{#KEY}] shared pool vol (4031)</name>
									<priority>WARNING</priority>
									<description>Query got hit by ora-4031, unable to allocate from shared pool</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}=1013
or
{str(timeout)}=1</expression>
									<name>zbxdb[query,{#SECTION},{#KEY}] timed out</name>
									<priority>INFO</priority>
									<description>socket.timeout</description>
								</trigger_prototype>
								<trigger_prototype>
									<expression>{last()}=57014</expression>
									<name>zbxdb[query,{#SECTION},{#KEY}] user canceled</name>
									<description>postgres cancel due to sql_timeout</description>
								</trigger_prototype>
							</trigger_prototypes>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
				<discovery_rule>
					<name>zbxdb sections</name>
					<type>TRAP</type>
					<key>zbxdb.section.lld</key>
					<delay>0</delay>
					<lifetime>1d</lifetime>
					<description>sections found in the checks parameter file, kind of self discovery</description>
					<item_prototypes>
						<item_prototype>
							<name>section[query_{#SECTION}__ela]</name>
							<type>TRAP</type>
							<key>zbxdb[query,{#SECTION},,ela]</key>
							<delay>0</delay>
							<history>1w</history>
							<trends>30d</trends>
							<value_type>FLOAT</value_type>
							<units>s</units>
							<description>time taken to process 1 section of checks</description>
							<applications>
								<application>
									<name>zbxdb</name>
								</application>
							</applications>
							<preprocessing>
								<step>
									<type>DISCARD_UNCHANGED_HEARTBEAT</type>
									<params>1d</params>
								</step>
							</preprocessing>
							<request_method>POST</request_method>
						</item_prototype>
					</item_prototypes>
					<request_method>POST</request_method>
				</discovery_rule>
			</discovery_rules>
			<macros>
				<macro>
					<macro>{$MONITORED_BY_PROXY}</macro>
					<value>proxy</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_ASM_LEFT_HIGH}</macro>
					<value>7d</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_ASM_LEFT_INFO}</macro>
					<value>30d</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_ASM_LEFT_WARN}</macro>
					<value>14d</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_ASM_PCTFREE_HIGH}</macro>
					<value>5</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_ASM_PCTFREE_INFO}</macro>
					<value>20</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_ASM_PCTFREE_WARN}</macro>
					<value>10</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_BKUP_AGE_FACTOR}</macro>
					<value>4</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_BKUP_MAX_ELA}</macro>
					<value>2h</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_BKUP_MAX_INCR_AGE}</macro>
					<value>3d</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_CONNECT_FAILED}</macro>
					<value>6m</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_NODATA}</macro>
					<value>6m</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_NODATA_HIGH}</macro>
					<value>1h</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_SCN_INCREASE}</macro>
					<value>30m</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_TS_HIGH}</macro>
					<value>3</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_TS_LEFTTIME}</macro>
					<value>1d</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_TS_LEFT_WARN}</macro>
					<value>7d</value>
				</macro>
				<macro>
					<macro>{$ZBXDB_TS_WARN}</macro>
					<value>10</value>
				</macro>
			</macros>
		</template>
	</templates>
	<triggers>
		<trigger>
			<expression>{template zbxDB:disks[count].last()}-{template zbxDB:disks[cached].last()} &gt; 0</expression>
			<name>ASM disks not all CACHED</name>
			<priority>AVERAGE</priority>
			<description>Could be a problems since normally all disks should be CACHED</description>
		</trigger>
	</triggers>
	<graphs>
		<graph>
			<name>zbxdb cpu</name>
			<graph_items>
				<graph_item>
					<color>C80000</color>
					<item>
						<host>template zbxDB</host>
						<key>zbxdb[cpu,sys]</key>
					</item>
				</graph_item>
				<graph_item>
					<sortorder>1</sortorder>
					<color>00C800</color>
					<item>
						<host>template zbxDB</host>
						<key>zbxdb[cpu,user]</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
		<graph>
			<name>zbxdb mem</name>
			<graph_items>
				<graph_item>
					<color>00C800</color>
					<item>
						<host>template zbxDB</host>
						<key>zbxdb[mem,maxrss]</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
		<graph>
			<name>zbxdb query ela</name>
			<graph_items>
				<graph_item>
					<color>00C800</color>
					<item>
						<host>template zbxDB</host>
						<key>zbxdb[query,,,ela]</key>
					</item>
				</graph_item>
			</graph_items>
		</graph>
	</graphs>
	<value_maps>
		<value_map>
			<name>feature usage</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>used</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>not in use</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>job enabled</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>disabled</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>enabled</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>job status</name>
			<mappings>
				<mapping>
					<value>-1</value>
					<newvalue>Unknow error</newvalue>
				</mapping>
				<mapping>
					<value>0</value>
					<newvalue>Failed</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>OK</newvalue>
				</mapping>
				<mapping>
					<value>2</value>
					<newvalue>Retry</newvalue>
				</mapping>
				<mapping>
					<value>3</value>
					<newvalue>Canceled</newvalue>
				</mapping>
				<mapping>
					<value>4</value>
					<newvalue>Running</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb arl_dest</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>OK</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>DEFERRED</newvalue>
				</mapping>
				<mapping>
					<value>2</value>
					<newvalue>ERROR</newvalue>
				</mapping>
				<mapping>
					<value>3</value>
					<newvalue>UNK</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb db.openstatus</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>*unknown*</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>MOUNTED</newvalue>
				</mapping>
				<mapping>
					<value>2</value>
					<newvalue>READ ONLY</newvalue>
				</mapping>
				<mapping>
					<value>3</value>
					<newvalue>READ WRITE</newvalue>
				</mapping>
				<mapping>
					<value>4</value>
					<newvalue>READ ONLY WITH APPLY</newvalue>
				</mapping>
				<mapping>
					<value>5</value>
					<newvalue>MIGRATE</newvalue>
				</mapping>
				<mapping>
					<value>6</value>
					<newvalue>OFFLINE</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb rman status</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>COMPLETED</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>FAILED</newvalue>
				</mapping>
				<mapping>
					<value>2</value>
					<newvalue>COMPLETED WITH WARNINGS</newvalue>
				</mapping>
				<mapping>
					<value>3</value>
					<newvalue>COMPLETED WITH ERRORS</newvalue>
				</mapping>
				<mapping>
					<value>4</value>
					<newvalue>noinfo</newvalue>
				</mapping>
				<mapping>
					<value>5</value>
					<newvalue>RUNNING</newvalue>
				</mapping>
				<mapping>
					<value>9</value>
					<newvalue>unk</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb[bct,status]</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>ENABLED</newvalue>
				</mapping>
				<mapping>
					<value>1</value>
					<newvalue>DISABLED</newvalue>
				</mapping>
				<mapping>
					<value>2</value>
					<newvalue>unknown</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb[checks,status]</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>OK</newvalue>
				</mapping>
				<mapping>
					<value>11</value>
					<newvalue>unreadable</newvalue>
				</mapping>
				<mapping>
					<value>13</value>
					<newvalue>parse error[s]</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb[connect,status]</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>OK</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb[query,,,status]</name>
			<mappings>
				<mapping>
					<value>0</value>
					<newvalue>OK</newvalue>
				</mapping>
			</mappings>
		</value_map>
		<value_map>
			<name>zbxdb_ms_Hadr</name>
			<mappings>
				<mapping>
					<value>disabled</value>
					<newvalue>13</newvalue>
				</mapping>
				<mapping>
					<value>healthy</value>
					<newvalue>0</newvalue>
				</mapping>
				<mapping>
					<value>missing group</value>
					<newvalue>42</newvalue>
				</mapping>
				<mapping>
					<value>out of sync</value>
					<newvalue>1</newvalue>
				</mapping>
			</mappings>
		</value_map>
	</value_maps>
</zabbix_export>
